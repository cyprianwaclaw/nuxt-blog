<template>
  <Transition
    @before-enter="BeforeEnterBg"
    @enter="EnterBg"
    @leave="LeaveBg"
    :css="false"
  >
    <div class="blur-background" v-if="props.modalActive" />
  </Transition>
  <Transition
    @before-enter="BeforeEnterModal"
    @enter="EnterModal"
    @leave="LeaveModal"
    :css="false"
  >
    <div
      class="modal"
      :style="{ maxWidth: props.width + 'px', height: props.height + 'px' }"
      v-if="props.modalActive"
    >
      <Icon
        name="carbon:close"
        size="31"
        class="flex absolute top-6 right-6 justify-end text-[#b7b6b6] hover:text-[#878787] hover:duration-150 cursor-pointer"
        @click="$emit('close')"
      />

      <div v-if="props.type" class="flex justify-center w-full -mt-[8px]">
        <svg
          v-if="props.type == 'error'"
          width="73"
          viewBox="0 0 256 256"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M164.24 100.24L136.48 128L164.24 155.76C164.83 156.309 165.302 156.972 165.63 157.708C165.958 158.444 166.135 159.238 166.149 160.044C166.163 160.849 166.015 161.65 165.713 162.397C165.411 163.144 164.962 163.823 164.392 164.392C163.823 164.962 163.144 165.411 162.397 165.713C161.65 166.015 160.849 166.163 160.044 166.149C159.238 166.135 158.444 165.958 157.708 165.63C156.972 165.302 156.309 164.829 155.76 164.24L128 136.48L100.24 164.24C99.1026 165.3 97.5983 165.877 96.0439 165.849C94.4895 165.822 93.0064 165.192 91.9071 164.093C90.8078 162.994 90.1781 161.511 90.1506 159.956C90.1232 158.402 90.7002 156.897 91.76 155.76L119.52 128L91.76 100.24C90.7002 99.1026 90.1232 97.5982 90.1506 96.0438C90.1781 94.4894 90.8078 93.0063 91.9071 91.907C93.0064 90.8077 94.4895 90.178 96.0439 90.1506C97.5983 90.1232 99.1026 90.7002 100.24 91.76L128 119.52L155.76 91.76C156.897 90.7002 158.402 90.1232 159.956 90.1506C161.511 90.178 162.994 90.8077 164.093 91.907C165.192 93.0063 165.822 94.4894 165.849 96.0438C165.877 97.5982 165.3 99.1026 164.24 100.24ZM230 128C230 148.174 224.018 167.894 212.81 184.668C201.602 201.442 185.672 214.516 167.034 222.236C148.396 229.956 127.887 231.976 108.101 228.04C88.3148 224.104 70.1401 214.39 55.8752 200.125C41.6102 185.86 31.8956 167.685 27.9599 147.899C24.0243 128.113 26.0442 107.604 33.7643 88.9663C41.4845 70.3282 54.5581 54.398 71.3319 43.1901C88.1057 31.9822 107.826 26 128 26C155.042 26.0318 180.968 36.7884 200.09 55.9102C219.212 75.032 229.968 100.958 230 128ZM218 128C218 110.2 212.722 92.7991 202.832 77.9987C192.943 63.1983 178.887 51.6627 162.442 44.8508C145.996 38.039 127.9 36.2567 110.442 39.7293C92.9836 43.202 76.9472 51.7737 64.3604 64.3604C51.7737 76.9471 43.202 92.9836 39.7294 110.442C36.2567 127.9 38.039 145.996 44.8509 162.442C51.6628 178.887 63.1983 192.943 77.9987 202.832C92.7991 212.722 110.2 218 128 218C151.861 217.974 174.738 208.483 191.61 191.61C208.483 174.738 217.974 151.861 218 128Z"
            fill="#C22B3A"
          />
        </svg>

        <svg
          v-if="props.type == 'warning'"
          width="73"
          viewBox="0 0 256 256"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M128 26C107.826 26 88.1057 31.9822 71.3319 43.1901C54.5581 54.398 41.4845 70.3282 33.7643 88.9663C26.0442 107.604 24.0243 128.113 27.9599 147.899C31.8956 167.685 41.6102 185.86 55.8752 200.125C70.1401 214.39 88.3148 224.104 108.101 228.04C127.887 231.976 148.396 229.956 167.034 222.236C185.672 214.516 201.602 201.442 212.81 184.668C224.018 167.894 230 148.174 230 128C229.968 100.958 219.212 75.032 200.09 55.9102C180.968 36.7884 155.042 26.0318 128 26ZM128 218C110.2 218 92.7991 212.722 77.9987 202.832C63.1983 192.943 51.6628 178.887 44.8509 162.442C38.039 145.996 36.2567 127.9 39.7294 110.442C43.202 92.9836 51.7737 76.9471 64.3604 64.3604C76.9472 51.7737 92.9836 43.202 110.442 39.7293C127.9 36.2567 145.996 38.039 162.442 44.8508C178.887 51.6627 192.943 63.1983 202.832 77.9987C212.722 92.7991 218 110.2 218 128C217.974 151.861 208.483 174.738 191.61 191.61C174.738 208.483 151.861 217.974 128 218ZM122 136V80C122 78.4087 122.632 76.8826 123.757 75.7574C124.883 74.6321 126.409 74 128 74C129.591 74 131.117 74.6321 132.243 75.7574C133.368 76.8826 134 78.4087 134 80V136C134 137.591 133.368 139.117 132.243 140.243C131.117 141.368 129.591 142 128 142C126.409 142 124.883 141.368 123.757 140.243C122.632 139.117 122 137.591 122 136ZM138 172C138 173.978 137.414 175.911 136.315 177.556C135.216 179.2 133.654 180.482 131.827 181.239C130 181.996 127.989 182.194 126.049 181.808C124.109 181.422 122.327 180.47 120.929 179.071C119.53 177.673 118.578 175.891 118.192 173.951C117.806 172.011 118.004 170 118.761 168.173C119.518 166.346 120.8 164.784 122.444 163.685C124.089 162.586 126.022 162 128 162C130.652 162 133.196 163.054 135.071 164.929C136.946 166.804 138 169.348 138 172Z"
            fill="#E1A817"
          />
        </svg>

        <svg
          v-if="props.type == 'success'"
          width="73"
          viewBox="0 0 256 256"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M176.3 99.9C176.844 100.462 177.27 101.126 177.554 101.855C177.839 102.583 177.976 103.36 177.957 104.142C177.939 104.923 177.765 105.693 177.446 106.407C177.127 107.121 176.67 107.765 176.1 108.3L117.5 164.3C116.359 165.368 114.862 165.974 113.3 166C111.766 165.978 110.299 165.37 109.2 164.3L79.9001 136.3C78.7596 135.213 78.0979 133.717 78.0604 132.141C78.0228 130.566 78.6127 129.04 79.7001 127.9C80.7874 126.76 82.2833 126.098 83.8586 126.06C85.4339 126.023 86.9596 126.613 88.1001 127.7L113.3 151.7L167.9 99.7C168.462 99.1565 169.126 98.7302 169.855 98.4457C170.583 98.1613 171.36 98.0244 172.142 98.043C172.923 98.0616 173.694 98.2353 174.407 98.5541C175.121 98.8729 175.765 99.3304 176.3 99.9ZM230 128C230 148.174 224.018 167.894 212.81 184.668C201.602 201.442 185.672 214.516 167.034 222.236C148.396 229.956 127.887 231.976 108.101 228.04C88.3148 224.104 70.1401 214.39 55.8752 200.125C41.6102 185.86 31.8956 167.685 27.9599 147.899C24.0243 128.113 26.0442 107.604 33.7643 88.9663C41.4845 70.3282 54.5581 54.398 71.3319 43.1901C88.1057 31.9822 107.826 26 128 26C155.036 26.0529 180.949 36.8162 200.067 55.9335C219.184 75.0508 229.947 100.964 230 128ZM218 128C218 110.2 212.722 92.7991 202.832 77.9987C192.943 63.1983 178.887 51.6627 162.442 44.8508C145.996 38.039 127.9 36.2567 110.442 39.7293C92.9836 43.202 76.9472 51.7737 64.3604 64.3604C51.7737 76.9471 43.202 92.9836 39.7294 110.442C36.2567 127.9 38.039 145.996 44.8509 162.442C51.6628 178.887 63.1983 192.943 77.9987 202.832C92.7992 212.722 110.2 218 128 218C151.861 217.974 174.738 208.483 191.61 191.61C208.483 174.738 217.974 151.861 218 128Z"
            fill="#21A67A"
          />
        </svg>
      </div>
      <div v-if="props.title" class="flex justify-center">
        <p class="text-[21px] font-medium mt-3 text-center leading-[28px]">
          {{ props.title }}
        </p>
      </div>
      <div v-if="props.text" class="flex justify-center">
        <p class="text-[17px] text-gray-500 mt-[6px] text-center px-3">
          {{ props.text }}
        </p>
      </div>
      <slot />
      <div class="flex justify-center w-full mt-[34px]">
        <button @click="$emit('confirmButton')" class="button-primary">
          {{ props.confirm }}
        </button>
      </div>
    </div>
  </Transition>
</template>

<script setup lang="ts">
import gsap from "gsap";
import { useAuth } from "@/store/useAuth";
const auth = useAuth();

const props = defineProps({
  title: {
    type: String,
    required: false,
  },
  text: {
    type: String,
    required: false,
  },
  modalActive: {
    type: Boolean,
    required: true,
  },
  type: {
    type: String,
    required: false,
  },
  confirm: {
    type: String,
    required: false,
  },
  width: {
    type: Number,
    required: false,
    default: 500,
  },
  height: {
    type: Number,
    required: false,
  },
});

const emit = defineEmits(["close", "confirmButton"]);

const EnterModal = (el: any, done: any) => {
  gsap.from(el, {
    duration: 0.24,
    y: 24,
  });
};
const LeaveModal = (el: any, done: any) => {
  gsap.to(el, {
    duration: 0.4,
    opacity: 0,
  });
  gsap.set(el, {
    delay: 0.5,
    display: "none",
  });
};

const BeforeEnterBg = (el: any) => {
  gsap.set(el, {
    opacity: 0,
  });
};
const EnterBg = (el: any, done: any) => {
  gsap.to(el, {
    opacity: 1,
    duration: 0.6,
  });
};
const LeaveBg = (el: any, done: any) => {
  gsap.to(el, {
    opacity: 0,
    duration: 0.4,
  });
  gsap.set(el, {
    delay: 0.4,
    display: "none",
  });
};
</script>

<style scoped lang="scss">
@import "@/assets/style/variables.scss";

</style>
